scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=1)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=2)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=3)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(...,low="0061FF", high= "FF0000" space = "Lab")
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_fill_gradient2(low="blue", high="red", mid="white", midpoint = 0, limit = c(-1,1), space = "Lab", name="Offensive Rating\nCoach Tenure")
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_fill_gradient2(low="blue", high="red", mid="white", midpoint = 0, limit = c(-1,1), space = "Lab", name="Offensive Rating\nCoach Tenure")
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red")
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red") + scale_x_ddiscrete(name = Coach Tenure (Years))
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red") + scale_x_ddiscrete(name = "Coach Tenure (Years)")
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red") + scale_x_discrete(name = "Coach Tenure (Years)")
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red") + scale_x_discrete(name = "Coach Tenure (Years)") + scale_y_discrete(name = "Offensive Rating")
scatteranim
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=5, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + scale_color_gradient(low = "blue", high = "red") + xlab("Coach Tenure (Years)") + ylab("Offensive Rating")
scatteranim
scale_fill_gradient2(low="blue", high="red", mid="white", midpoint = 0, limit = c(-1,1), space = "Lab", name="Dependent Variable\nCorrelation")
hitchanim <- scatteranim + transition_time(NBAYear) + labs(title = "Year: {frame_time}") + shadow_mark(alpha = 0.7, size = 1) + ease_aes('cubic-in-out')
hitchanim
animate(hitchanim, nframes = 100, end_pause = 10, height = 500, width = 600)
animate(hitchanim, nframes = 100, end_pause = 10, height = 500, width = 500)
animate(hitchanim, nframes = 100, end_pause = 10, height = 400, width = 600)
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=6, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
hitchanim <- scatteranim + transition_time(NBAYear) + labs(title = "Year: {frame_time}") + shadow_mark(alpha = 0.7, size = 2) + ease_aes('cubic-in-out')
animate(hitchanim, nframes = 100, end_pause = 10, height = 500, width = 600)
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=6, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1)
scatteranim
hitchanim <- scatteranim + transition_time(NBAYear) + labs(title = "Year: {frame_time}") + shadow_mark(alpha = 0.7, size = 2) + ease_aes('cubic-in-out')
hitchanim
hitchanim <- scatteranim + transition_time(NBAYear) + labs(title = "Year: {frame_time}") + shadow_mark(alpha = 0.7, size = 1) + ease_aes('cubic-in-out')
hitchanim
animate(hitchanim, nframes = 100, end_pause = 10, height = 500, width = 600)
scatteranim <- ggplot(nbadat6, aes(x=Coach.Tenure, y=OFFRTG, colour=NBAYear, shape=NBAYear, label = paste("(",Team,",",NBAYear,")"))) + geom_point(size=6, shape=20)  + geom_label_repel(data = subset(nbadat6,Coach.Tenure>10), size=3) + scale_shape_identity()  + geom_label_repel(data = subset(nbadat6, OFFRTG<100), size = 3) + geom_hline(aes(yintercept=mean(OFFRTG)), color="blue", linetype="dashed", size=1) + xlab("Coach Tenure (Years)") + ylab("Offensive Rating")
hitchanim <- scatteranim + transition_time(NBAYear) + labs(title = "Year: {frame_time}") + shadow_mark(alpha = 0.7, size = 1) + ease_aes('cubic-in-out')
animate(hitchanim, nframes = 100, end_pause = 10, height = 500, width = 600)
anim_save()
anim_save("D:/Rlearning", animation = last_animation)
anim_save("D:/Rlearning")
fixedper <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure + TOV, data=pdata6, model= "within")
install.packages("plm")
install.packages("Formula")
library("plm")
library("Formula")
fixed <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure + TOV, data=pdata6, model= "within")
summary(fixed)
fixedlog <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure + TOV, data=pdata6, model= "within")
knitr::kable(summary(fixedlog)$coefficients)
fixedlogRTG <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure +OFFRTG + DEFRTG + TOVpercent, data=pdata6, model= "within")
knitr::kable(summary(fixedlogRTG)$coefficients)
randomlog <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure + TOV, data=pdata6, model= "random")
knitr::kable(summary(randomlog)$coefficients)
> fixedlogRTG <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure +OFFRTG + DEFRTG + TOV, data=pdata6, model= "within")
fixedlogRTG <- plm(Wins ~ logCAP + Avg.Age + Coach.Tenure +OFFRTG + DEFRTG + TOV, data=pdata6, model= "within")
knitr::kable(summary(fixedlogRTG)$coefficients)
\
install.packages("XML")
library(XML)
url <- "https://stats.nba.com/leaders/"
2018league <- readHTMLTable(url, which=2)
2018league <- readHTMLTable(url)
leaguestats <- readHTMLTable(url)
leaguestats <- readHTMLTable(url, which = 1)
install.packages("RCurl")
library(RCurl)
library(bitops)
library(RCurl)
urldata <- getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
View(data)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
urldata <-  getURL(url)
2018player <- readHTMLTable(urldata, stringsAsFactors = FALSE)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
View(data)
data <- readHTMLTable(urldata, header = TRUE, stringsAsFactors = FALSE)
View(data)
rbind(data)
data2 <- rbind(data)
View(data2)
View(data)
structure(data, row.names = c(NA, -n), .Names = seq_along(L), class = "data.frame")
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(L), class = "data.frame")
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
View(dat)
str(dat)
install.packages("XML")
install.packages("RCurl")
library(XML)
library(RCurl)
url2 <- "https://stats.nba.com/leaders/"
urldata2 <-  getURL(url)
data2 <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat2 <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
install.packages("RCurl")
> url2 <- "https://stats.nba.com/leaders/"
> urldata2 <-  getURL(url)
> data2 <- readHTMLTable(urldata, stringsAsFactors = FALSE)
> dat2 <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
url2 <- "https://stats.nba.com/leaders/"
urldata2 <-  getURL(url)
data2 <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat2 <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat2)
datTOT <- dat(ifelse("1.Age"= "TOT", NULL))
datTOT <- ifelse(dat$1.Tm == "TOT", 1, 0)
datTOT <- ifelse(dat$1.Tm[1:734] == "TOT", 1, 0)
datTOT <- ifelse(dat$1.Tm[1:734] == "TOT", 1, NULL)
datTOT <- subset(dat, 1.Tm == "TOT")
datTOT <- subset(dat, 1.Tm = "TOT")
datTOT <- subset(dat, 1.Tm = "TOT")
colnames(dat)[5] <- "Team"
dat$Team <- dat$1.Tm
colnames(dat) <- c("Rank")
View(dat)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, check.names = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
names(dat) <- str_replace_all(names(dat), c(" " = "."))
install.packages("stringr")
library(stringr)
names(dat) <- str_replace_all(names(dat), c(" " = "."))
View(dat)
colnames(dat)[5] <- "Team"
dat$Team <- dat$1.Tm
dat$Team <- dat$1.Tm
install.packages("tidyverse")
install.packages("janitor")
library(janitor)
clean_names(dat)
View(dat)
dat <- clean_names(dat)
View(dat)
colnames(dat)[5] <- "Team"
dat$Team <- dat$1.Tm
colnames(dat)[1] <- "Team"
View(dat)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
names(dat) <- gsub("\\s","_", names(dat))
View(dat)
colnames(dat) <- gsub("\\s","_", colnames(dat))
View(dat)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, header = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
colnames(dat) <- c("good","better")
colnames(dat) <- c(“a”,”b”,”c”,”d”,”e”,”f”,”g”,”h”,”i”,”j”,”k”,”l”,”m”,”n”,”o”,”p”,”q”,”r”,”s”,”t”,”u”,”v”,”w”,”x”,”y”,”z”,”aa”,”bb”,”cc”,”dd”)
colnames(dat) <- c(“a”,”b”,”c”,”d”,”e”,”f”,”g”,”h”,”i”,”j”,”k”,”l”,”m”,”n”,”o”,”p”,”q”,”r”,”s”,”t”,”u”,”v”,”w”,”x”,”y”,”z”,”aa”,”bb”,”cc”,”dd)
dat <- structure(data, row.names = c(NA, -734), class = "data.frame")
View(dat)
View(dat)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
#
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE, header = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
View(dat)
View(data)
as.data.frame(dat)
dat3 <- as.data.frame(data)
View(dat3)
dat3 <- as.data.frame(data, col.names = names(data), stringsAsFactor = TRUE)
View(dat3)
str(dat3)
dat3 <- as.data.frame(data, col.names = names(data))
View(dat3)
str(dat3)
colnames(dat3)[1] <- "Rank"
colnames(dat3)[2] <- "Player"
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
View(dat3)
View(data)
data
per_game_stats
View(dat3)
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
library(XML)
library(RCurl)
library(plyr)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
str(dat)
playerstats18 <- ldply(data, data.frame)
colnames(playerstats18)[12] <- "FGpct"
colnames(playerstats18)[13] <- "3P"
colnames(playerstats18)[14] <- "3PA"
colnames(playerstats18)[15] <- "3Ppct"
colnames(playerstats18)[16] <- "2P"
colnames(playerstats18)[17] <- "2PA"
colnames(playerstats18)[18] <- "2Ppct"
colnames(playerstats18)[19] <- "eFG"
colnames(playerstats18)[22] <- "FTpct"
TOTplayer <- subset(playerstats18, Tm == "TOT")
playerstatsTraded <- subset(playerstats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
playerstatsTradednegative <- subset(playerstats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
playerstatscomb <- rbind(playerstatsTradednegative, TOTplayer)
##Eliminating the "player" headers from the HTML Table
playerstatscomb2 <- subset(playerstatscomb, Player %ni% c("Player"))
playerstatsSD <- sapply(playerstatscomb2, na.rm = FALSE, sd)
playerstatsSD <- sapply(playerstatscomb2, na.rm = TRUE, sd)
?convert
as.numeric(playerstatscomb2[10])
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
library(XML)
library(RCurl)
library(plyr)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
playerstats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(playerstats18)[12] <- "FGpct"
colnames(playerstats18)[13] <- "3P"
colnames(playerstats18)[14] <- "3PA"
colnames(playerstats18)[15] <- "3Ppct"
colnames(playerstats18)[16] <- "2P"
colnames(playerstats18)[17] <- "2PA"
colnames(playerstats18)[18] <- "2Ppct"
colnames(playerstats18)[19] <- "eFG"
colnames(playerstats18)[22] <- "FTpct"
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(playerstats18, Tm == "TOT")
##Removing duplicates and adding in traded players totals
playerstatsTraded <- subset(playerstats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
playerstatsTradednegative <- subset(playerstats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
playerstatscomb <- rbind(playerstatsTradednegative, TOTplayer)
##Eliminating the "player" headers from the HTML Table
playerstatscomb2 <- subset(playerstatscomb, Player %ni% c("Player"))
mean(MP)
mean(playerstatscomb2$MP)
mean(playerstatscomb2)
mean(playerstatscomb2, MP)
mean(playerstatscomb2, "MP")
sapply(playerstatscomb2, sd, na.rm)
sapply(playerstatscomb2, sd, na.rm = TRUE)
playerstatsSD <- sapply(playerstatscomb2, sd, na.rm = TRUE)
sapply(playerstatscomb2, mean)
sapply(playerstatscomb2, mean, na.rm = TRUE)
str(playerstatscomb2)
playerstatscomb2 <- as.data.frame(sapply(playerstatscomb2[7:31], 2, as.numeric))
playerstatscomb2 <- as.data.frame(sapply(playerstatscomb2[7:31], as.numeric))
str(playerstatscomb2)
View(playerstatscomb2)
playerstatsSD <- sapply(playerstatscomb2, sd, na.rm = TRUE)
View(playerstatsTradednegative)
View(playerstatscomb2)
playerstatscomb2$MPSD <- sd(playerstatscomb2$MP)
View(playerstatscomb2)
playerstatscomb2$MPSD <- sd(c(playerstatscomb2$MP)
)
View(playerstatscomb2)
mean(playerstatscomb2$`3PA`)
sd(playerstatscomb2$'3PA')
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
library(XML)
library(RCurl)
library(plyr)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
playerstats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(playerstats18)[12] <- "FGpct"
colnames(playerstats18)[13] <- "3P"
colnames(playerstats18)[14] <- "3PA"
colnames(playerstats18)[15] <- "3Ppct"
colnames(playerstats18)[16] <- "2P"
colnames(playerstats18)[17] <- "2PA"
colnames(playerstats18)[18] <- "2Ppct"
colnames(playerstats18)[19] <- "eFG"
colnames(playerstats18)[22] <- "FTpct"
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(playerstats18, Tm == "TOT")
##Removing duplicates and adding in traded players totals
playerstatsTraded <- subset(playerstats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
playerstatsTradednegative <- subset(playerstats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
playerstatscomb <- rbind(playerstatsTradednegative, TOTplayer)
##Eliminating the "player" headers from the HTML Table
playerstatscomb2 <- subset(playerstatscomb, Player %ni% c("Player"))
playerstatscomb2[is.na(playerstatscomb2)] <- 0
View(playerstatscomb2)
View(playerstatscomb)
View(playerstatscomb2)
playerstatscomb2$MPSD <- sd(c(playerstatscomb2$MP)
)
summary(playerstatscomb2$`3PA`)
head(3P)
install.packages("XML")
install.packages("RCurl")
install.packages("plyr")
library(XML)
library(RCurl)
library(plyr)
url <- "https://www.basketball-reference.com/leagues/NBA_2019_per_game.html"
# These produce the same results: url <- "https://stats.nba.com/leaders/"
urldata <-  getURL(url)
data <- readHTMLTable(urldata, stringsAsFactors = FALSE)
dat <- structure(data, row.names = c(NA, -734), .Names = seq_along(data), class = "data.frame")
#This one does not work
dat3 <- as.data.frame(data, col.names = names(data), headers = TRUE)
#This one works - But all variables are characteristic
stats18 <- ldply(data, data.frame)
# Adjusting variable names
colnames(stats18)[12] <- "FGpct"
colnames(stats18)[13] <- "3P"
colnames(stats18)[14] <- "3PA"
colnames(stats18)[15] <- "3Ppct"
colnames(stats18)[16] <- "2P"
colnames(stats18)[17] <- "2PA"
colnames(stats18)[18] <- "2Ppct"
colnames(stats18)[19] <- "eFG"
colnames(stats18)[22] <- "FTpct"
#Isolating all traded players that show up as double in the data set
TOTplayer <- subset(stats18, Tm == "TOT")
##Cleaning traded duplicates and adding in traded players totals
statsTraded <- subset(stats18, Player %in% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
"%ni%" <- Negate("%in%")
statsnotTraded <- subset(stats18, Player %ni% c("Ryan Anderson", "Trevor Ariza", "Ron Baker", "Harrison Barnes", "Avery Bradley", "Corey Brewer", "Reggie Bullock", "Trey Burke", "Alec Burks", "Jimmy Butler", "Isiah Canaan", "Michael Carter-Williams", "Tyson Chandler", "Wilson Chandler", "Marquese Chriss", "Robert Covington", "Mitch Creek", "Sam Dekker", "Matthew Dellavedova", "Tyler Dorsey", "Henry Ellenson", "Wayne Ellington", "James Ennis", "Jawun Evans", "Kenneth Faried", "Tim Frazier", "Marc Gasol", "Pau Gasol", "JaMychal Green", "Tim Hardaway", "Tobias Harris", "Andrew Harrison", "George Hill", "Justin Holiday", "Rodney Hood", "Justin Jackson", "John Jenkins", "B.J. Johnson", "Stanley Johnson", "Tyler Johnson", "Wesley Johnson", "DeAndre Jordan","Enes Kanter", "Brandon Knight", "Kyle Korver", "Skal Labissiere", "Courtney Lee", "Jeremy Lin", "Timothe Luwawu-Cabarrot", "Shelvin Mack", "Thon Maker", "Boban Marjanovic", "Wesley Matthews", "Patrick McCaw", "C.J. Miles", "Nikola Mirotic", "Greg Monroe", "Eric Moreland", "Markieff Morris", "Mike Muscala", "Sviatoslav Mykhailiuk", "James Nunnally", "Kelly Oubre", "Jabari Parker", "Cameron Payne", "Otto Porter", "Bobby Portis", "Austin Rivers", "Dario Saric", "Mike Scott", "Wayme Selden", "Landry Shamet", "Iman Shumpert", "Jonathon Simmons", "Dennis Smith", "Jason Smith", "Ray Spalding", "Nik Stauskas", "Caleb Swanigan", "Garrett Temple", "Emanuel Terry", "Jonas Valanciunas", "Christian Wood", "Delon Wright", "Tyler Zeller", "Ivica Zubac"))
statsbind <- rbind(playerstatsTradednegative, TOTplayer)
##Eliminating the "player" headers from the HTML Table
statsbind2 <- subset(playerstatscomb, Player %ni% c("Player"))
statsbind2[is.na(statsbind2)] <- 0
colvars(statsbind2, suma = NULL, std = FALSE)
colVars(statsbind2, suma = NULL, std = FALSE)
sapply(statsbind2, var)
View(statsbind2)
sapply(statsbind2$MP, var)
statsvar <- sapply(statsbind2$MP, var)
statsvar
mean(statsbind2$MP)
str(statsbind2)
statsbind2 <- as.data.frame(sapply(statsbind2[7:31], as.numeric))
mean(statsbind2$MP)
statsbind2 <- subset(playerstatscomb, Player %ni% c("Player"))
statsbind2 <- as.data.frame(sapply(statsbind2[1:31], as.numeric))
str(statsbind2)
statsbind2 <- subset(playerstatscomb, Player %ni% c("Player"))
statsbind2$.id <- NULL
statsbind2$Rk <- NULL
str(statsbind2)
statsbind2[,c(3,5:29)] <- sapply(statsbind2[, c(3,5:29)], as.numeric)
View(statsbind2)
str(statsbind2)
mean(statsbind2$PTS)
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statszscores <- (statsbind2[5:29] - mean(statsbind2[5:29]))/sd(statsbind2[5:29])
statsbind2[is.na(statsbind2)] <- 0
statszscores <- (statsbind2[5:29] - mean(statsbind2[5:29]))/sd(statsbind2[5:29])
statszscores <- sapply((statsbind2[5:29] - mean(statsbind2[5:29]))/sd(statsbind2[5:29]))
statszscores <- sapply(statsbind2[5:29], sd)
statszscores[1:24] <- sapply(statsbind2[5:29], sd)
statszscores[1:25] <- sapply(statsbind2[5:29], sd)
str(statsbind2)
statszscores <- sapply((statsbind2[,5:29] - mean(statsbind2[,5:29]))/sd(statsbind2[,5:29]))
statszscores <- (statsbind2[,5:29] - mean(statsbind2[,5:29]))/sd(statsbind2[,5:29])
statsbind2$PTSscale <- scale(statsbind2$PTS)
View(statsbind2)
statsbindScale <- scale(statsbind2[,5:29])
View(statsbindScale)
ifelse(statsbind2$PTSZ == statsbindScale$PTS, 1, 9)
ifelse(statsbind2$PTSZ == statsbindScale$PTS, 1, 0)
ifelse(statsbind2["PTSZ"] == statsbindScale["PTS"], 1, 0)
statScaleSum <- rowSum(statsbindScale, na.rm = TRUE)
statScaleSum <- rowSums(statsbindScale, na.rm = TRUE)
statScaleSum
view(statScaleSum)
View(statsbindScale)
typeof(statsbindScale)
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
View(statscbindScale)
statscbindScale[,29] <- rowSums(statscbindScale[7,9,10,12])
statscbindScale[,29] <- rowSums(statscbindScale[c(7,9,10,12)]
)
View(statscbindScale)
statscbindScale[,29] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,-26,-27,28)])
statscbindScale[,29] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,26*-1,27*-1,28)])
statscbindScale[,29] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,26,27,28)])
View(statscbindScale)
statscbindScale$NegTOV <- -1(statscbindScale$TOV)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
View(statscbindScale)
statscbindScale$NegPF <- statscbindScale$PF * -1
statscbindScale[,29] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28, 30, 31)])
View(statscbindScale)
install.packages("ggplot2")
library(ggplot2)
ggplot(statscbindScale, aes(x='Basketball Player', y=Combined Z Score)) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
ggplot(statscbindScale, aes(x='Basketball Player', y='Combined Z Score')) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
ggplot(statscbindScale, aes(x='Basketball Player', y=statscbindScale[,29])) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
ggplot(statscbindScale, aes(x='Basketball Player', y=statscbindScale[,29])) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF", "#000000", "#800000", "#FFFF00", "#808000", "#00FF00", "#008000", "#00FFFF", "#008080", "#0000FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
ggplot(statscbindScale[,29], aes(x='Basketball Player', y=statscbindScale[,29])) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF", "#000000", "#800000", "#FFFF00", "#808000", "#00FF00", "#008000", "#00FFFF", "#008080", "#0000FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
ggplot(statscbindScale[,29], aes(x='Basketball Player', y=statscbindScale[,29])) + geom_bar(stat='identity',aes(fill=Pos), width = .5) + scale_fill_manual(labels = c("Above Average", "Below Average"), values = c("above"="#FF2E00", "below"="#0078FF", "#000000", "#800000", "#FFFF00", "#808000", "#00FF00", "#008000", "#00FFFF", "#008080", "#0000FF")) + labs(title = "Normalized Player Production in the 2018-2019 Season") + coord_flip()
install.packages("ggplot2")
library(ggplot2)
statscbindScale[29] <- statscbindScale$combined_z
View(statscbindScale)
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,5:29])
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
##Creating the all-in-one value
statscbindScale[,29] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28, 30, 31)])
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,5:29])
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,5:29])
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
##Creating the all-in-one value
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
statsbind2$PTSZ <- (statsbind2$PTS - mean(statsbind2$PTS))/sd(statsbind2$PTS)
statsbindScale <- scale(statsbind2[,5:29])
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
##Creating the all-in-one value
statscbindScale$combinded_z <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
View(statscbindScale)
statscbindScale$combined_Z <- statscbindScale[,31]/12
View(statscbindScale)
statscbindScale$abovebelow_z <- ifelse(statscbindScale$combined_z < 0, "below", "above")
statscbindScale$abovebelow_z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
ggplot(statscbindScale, aes(x=Player, y=combined_Z, label=Combined Z Score)) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + Scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(statscbindScale, aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + Scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(statscbindScale, aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale$MP > .50), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + Scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, MP > .50), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + Scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, MP > .50), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, MP > .50 & G > -0.13), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, MP > .50 & G > .35), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, MP > .50 & GS > .66), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 & combined_Z > 1), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1 & GS > -.77), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1 & GS > -.36), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1 & GS > -.77), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1 & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.3 | combined_Z > 1 & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.5 | combined_Z > 1 & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.8 | combined_Z > 1 & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, combined_Z < -.8 | combined_Z > 1 & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & GS > .61), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & GS > .0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & GS > -.5), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & GS > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.5), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -2), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
install.packages("ggplot")
install.packages("ggplot2")
library(ggplot2)
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
statscbindScale <- statscbindScale[order(statscbindScale$combined_Z),]
View(statscbindScale)
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
statscbindScale$Player <- factor(statscbindScale$Player, levels = mtcars$Player)
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
statscbindScale <- cbind(statsbind2[c(1,2,4)], statsbindScale)
statscbindScale$NegTOV <- statscbindScale$TOV * -1
statscbindScale$NegPF <- statscbindScale$PF * -1
statscbindScale[,31] <- rowSums(statscbindScale[c(10,13,16,17,20,21,23,24,25,28,29,30)])
statscbindScale$combined_Z <- statscbindScale[,31]/12
statscbindScale$abovebelow_Z <- ifelse(statscbindScale$combined_Z < 0, "below", "above")
statscbindScale <- statscbindScale[order(statscbindScale$combined_Z),]
ggplot(subset(statscbindScale, (combined_Z < -.8 | combined_Z > 1) & G > -1.0), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale), aes(x=Player, y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
ggplot(subset(statscbindScale, G > 1.0), aes(x=reorder(Player,combined_Z), y=combined_Z, label="Combined Z Score")) + geom_bar(stat='identity', aes(fill=abovebelow_Z), width=.5) + scale_fill_manual(name="Mileage", labels=c("Above Average", "Below Average"), values=c("above"="#FF2E00", "below"="#0078FF")) +labs(title ="Normalized Production for the 2018-19 NBA Season") + coord_flip()
setwd("D:\RLearning\All-in-one")
setwd("D:/RLearning/All-in-one")
getwd()
